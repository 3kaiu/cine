# Cine 更新日志

## [v0.6.0]

### 新增功能

#### 测试体系
- ✅ **完整的测试基础设施**
  - 后端单元测试框架
  - 后端集成测试框架
  - 前端单元测试框架（Vitest）
  - 前端 E2E 测试框架（Playwright）
  - 性能测试框架（Criterion）

- ✅ **测试覆盖**
  - 文件扫描服务测试
  - 哈希计算服务测试
  - 文件重命名服务测试
  - 缓存机制测试
  - 文件操作测试
  - 回收站功能测试
  - 元数据刮削测试
  - 前端组件测试
  - 前端工具函数测试
  - E2E 用户流程测试

- ✅ **CI/CD 集成**
  - GitHub Actions 测试工作流
  - 自动化测试运行
  - 代码覆盖率报告
  - 测试结果上传

- ✅ **测试工具和配置**
  - 测试工具函数和 Mock
  - 测试数据生成
  - 测试环境配置
  - 覆盖率配置

### 改进

- 🔧 **代码质量**
  - 提高测试覆盖率
  - 更好的错误处理测试
  - 边界条件测试

- 🔧 **开发体验**
  - 快速测试反馈
  - 测试 UI 工具
  - 详细的测试文档

## [v0.5.0]

### 新增功能

#### 后端
- ✅ **文件移动/复制功能**
  - 单个文件移动/复制
  - 批量文件移动/复制
  - 流式复制（支持大文件）
  - 自动创建目标目录

- ✅ **回收站功能**
  - 文件删除到回收站
  - 从回收站恢复文件
  - 永久删除功能
  - 自动清理过期文件
  - 回收站列表查看

- ✅ **缓存机制优化**
  - 文件哈希值缓存
  - 基于文件修改时间的缓存键
  - 内存缓存管理
  - 缓存统计和清理

#### 前端
- ✅ **文件管理页面**
  - 文件列表展示
  - 多选文件
  - 批量移动/复制
  - 操作结果反馈

- ✅ **回收站页面**
  - 已删除文件列表
  - 恢复文件功能
  - 永久删除功能
  - 清理过期文件

#### 部署
- ✅ **fpk 打包脚本**
  - 自动化打包流程
  - 构建前后端
  - 生成配置文件

- ✅ **CI/CD 配置**
  - GitHub Actions 工作流
  - 自动化测试
  - Docker 镜像构建

### 改进

- 🔧 **性能优化**
  - 哈希值缓存减少重复计算
  - 文件操作错误处理优化

- 🔧 **用户体验**
  - 更好的文件操作反馈
  - 回收站安全删除机制

## [v0.4.0]

### 新增功能

#### 后端
- ✅ **统一错误处理系统**
  - 定义统一的错误类型
  - 自动转换为 HTTP 响应
  - 用户友好的错误消息

- ✅ **字幕文件匹配**
  - 自动查找匹配的字幕文件
  - 支持多种字幕格式（SRT, ASS, VTT）
  - 语言检测和识别
  - 智能文件名匹配

#### 前端
- ✅ **暗色主题支持**
  - 主题切换功能
  - 自动检测系统偏好
  - 持久化主题设置

- ✅ **错误处理优化**
  - 统一错误处理工具
  - 用户友好的错误提示
  - 错误消息映射表

- ✅ **加载状态优化**
  - LoadingWrapper 组件
  - 统一的加载状态显示
  - 更好的用户体验

- ✅ **响应式设计**
  - 移动端适配
  - 响应式布局
  - 自适应侧边栏

- ✅ **错误边界**
  - React ErrorBoundary
  - 优雅的错误恢复
  - 错误日志记录

#### 部署
- ✅ **Docker 支持**
  - 多阶段构建 Dockerfile
  - Docker Compose 配置
  - 健康检查
  - 数据持久化

### 改进

- 🔧 **用户体验**
  - 更好的错误提示
  - 统一的加载状态
  - 主题切换体验

- 🔧 **代码质量**
  - 统一错误处理
  - 更好的类型安全
  - 代码组织优化

## [v0.3.0]

### 新增功能

#### 后端
- ✅ **批量刮削功能**
  - 支持批量处理多个文件
  - 进度跟踪和错误处理
  - 可配置下载图片和生成 NFO

- ✅ **海报和背景图下载**
  - 自动下载 TMDB 海报
  - 自动下载背景图
  - 保存到文件同目录

- ✅ **NFO 文件生成**
  - 支持 Kodi/Jellyfin 格式
  - 电影和剧集 NFO 生成
  - XML 格式，包含完整元数据

#### 前端
- ✅ **刮削结果预览和选择**
  - 显示多个匹配结果
  - 海报预览
  - 点击选择匹配结果

- ✅ **批量刮削界面**
  - 多选文件
  - 批量操作
  - 结果显示

- ✅ **增强的刮削页面**
  - 下载选项配置
  - NFO 生成选项
  - 元数据可视化

### 改进

- 🔧 **用户体验**
  - 更直观的元数据展示
  - 更好的错误提示
  - 操作反馈优化

## [v0.2.0]

### 新增功能

#### 后端
- ✅ **空文件夹查找功能**
  - 智能识别空文件夹
  - 自动分类（缓存、构建产物、系统目录、其他）
  - 支持批量删除
  - 按深度和分类筛选

- ✅ **WebSocket 进度推送完善**
  - 文件扫描任务实时进度
  - 哈希计算任务实时进度
  - 支持多任务并发推送
  - 任务状态实时更新

#### 前端
- ✅ **空文件夹清理页面**
  - 可视化空文件夹列表
  - 按分类筛选和统计
  - 批量删除功能
  - 删除确认机制

- ✅ **进度监控组件**
  - 实时显示任务进度
  - WebSocket 连接状态
  - 当前处理文件信息
  - 任务类型标识

### 改进

- 🔧 **性能优化**
  - 文件扫描进度估算优化
  - 哈希计算进度推送频率优化
  - 数据库查询优化

- 🔧 **用户体验**
  - 扫描页面集成进度监控
  - 更好的错误提示
  - 加载状态优化

### 修复

- 🐛 修复数据库时间戳格式问题
- 🐛 修复 WebSocket 连接管理
- 🐛 修复空文件夹查找的边界情况

## [v0.1.0]

### 初始版本

#### 核心功能
- ✅ 文件扫描
- ✅ 流式哈希计算（支持 100GB+ 文件）
- ✅ 视频信息提取（ffprobe）
- ✅ 元数据刮削（TMDB API）
- ✅ 批量重命名
- ✅ 文件去重
- ✅ 大文件查找
- ✅ WebSocket 实时通信框架

#### 技术栈
- 后端：Rust + Axum + SQLite
- 前端：React + Vite + TypeScript + Ant Design
